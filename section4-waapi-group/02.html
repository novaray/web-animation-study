<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>그룹으로 애니메이션 적용하기</title>
	<style>
		.bar-container {
			display: flex;
			align-items: flex-end;
		}
		.bar {
			width: 10px;
			height: 200px;
			margin: 0 10px;
			background-color: lightgray;
			transform-origin: bottom;
			will-change: transform;
		}
		.bar:nth-child(5n+1) { background-color:crimson; }
		.bar:nth-child(5n+2) { background-color: gold; }
		.bar:nth-child(5n+3) { background-color: forestgreen; }
		.bar:nth-child(5n+4) { background-color: dodgerblue; }
		.bar:nth-child(5n+5) { background-color: darkorchid; }
	</style>
</head>
<body>
	<div class="bar-container">
	</div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web-animations/2.3.2/web-animations-next.min.js"></script>
	
	<script>
    const barContainer = document.querySelector('.bar-container');
    const bars = [];
    
    for (let i = 0; i < 30; i++) {
      const bar = document.createElement('div');
      bar.classList.add('bar');
      barContainer.append(bar);
      bars.push(bar);
    }
    
    const keyframes = [
      { transform: 'scaleY(0)'},
      { transform: 'scaleY(1)'}
    ];
    const options = {
      duration: 3000,
      iterations: Infinity,
      direction: 'alternate',
      fill: 'both',
      easing: 'ease-in-out'
    };
    
    const effects = [];
    bars.forEach((bar, i) => {
      const newOptions = {
        ...options,
        delay: i * 100
      };
      const effect = new KeyframeEffect(bar, keyframes, newOptions);
      effects.push(effect);
    });
    
    const groupEffect = new GroupEffect(effects);
    const animation = document.timeline.play(groupEffect);
    
    setTimeout(() => {
      animation.pause();
    }, 3000);
    
    // bars.forEach((bar, i) => {
    //   bar.animate(keyframes, {
    //     ...options,
    //     delay: i * 100
    //   });
    // });
  </script>
</body>
</html>
